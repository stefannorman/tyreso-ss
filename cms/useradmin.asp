<%@ LANGUAGE = JScript %><!--#include file="basicfuncs.asp" -->    <!--#include file="data/database.asp" -->   <% if(true) { %><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" >	<head>		<!--#include file="../includes/htmlhead.htm"-->		<style type="text/css">		@import url("/css/tss.css");		</style>	</head>	<body onload="showBanner()">	<%	//sendEmail("stefan.norman@home.se", "Goodmoooorning SubRoutine", "fett me fett");	var roleArr = new Array("admin", "editor", "racereg", "kansli", "coach", "records", "TF", "DF", "UF", "XF", "sekreteriat", "kafeterian", "praktik");		var id = toString(Request("id"));	var medlemsnr = toString(Request("medlemsnr"));	var _medlemsnr = "";	var _username = "";	var _password = "";	var _name = "";	var _email = "";	var _phone = "";	var _mobile = "";	var _bonus = 0;	var _bonus_2007 = 0;	var _roles = "";	if(id != "") {		%>		<%		var users = Server.CreateObject("adodb.recordset");		var sql = "SELECT * FROM user WHERE id="+id;		users.open(sql,connect,1,1);		if(!users.EOF) {			_medlemsnr = toString(users("medlemsnr"));			_username = toString(users("username"));			_password = toString(users("password"));			_name = toString(users("name"));			_email = toString(users("email"));			_phone = toString(users("phone"));			_mobile = toString(users("mobile"));//			_bonus = toInt(users("bonus"));//			_bonus_2007 = toInt(users("bonus_2007"));			_bonus = users("bonus");			_bonus_2007 = users("bonus_2007");			_roles = toString(users("roles"));		}	}	%>		<div id="wrapper">		<div id="header">			<!--#include file="../includes/header.htm"-->		</div>		<div id="main">			<div id="menuColumn">				<!--#include file="../includes/menu.asp"-->			</div>			<div id="contentColumn">				<div class="box">					<div class="header">.: <%=id != "" ? "Ändra" : "Ny"%> användare :.</div>					<div class="content">					<form action="saveuser.asp" method="post">						<% if(id != "") { %>							<input type="hidden" name="id" value="<%=id%>"/>							<input type="hidden" name="medlemsnr" value="<%=_medlemsnr%>"/>						<% } else { %>							<select name="medlemsnr" onchange="location='?action=new&medlemsnr=' + this.value">							<option value="-1">Finns ej i Servette</option>							<%							var query = Server.CreateObject("adodb.recordset");							var sql = "SELECT medlemsnummer, förnamn, efternamn, epost, [Telefon hem] as phone, mobilnr FROM medlemmar ORDER BY förnamn, efternamn";							// var sql = "SELECT medlemsnummer, förnamn, efternamn, epost FROM medlemmar WHERE medlemsnummer IN (select instruktörsID from aktivitetsgrupper) OR medlemsnummer IN (select assistentID from aktivitetsgrupper) ORDER BY förnamn, efternamn";							query.open(sql,servette,1,1);							while(!query.EOF) {								if(medlemsnr == query("medlemsnummer")) {									_name = query("förnamn") + " " + query("efternamn");									_email = toString(query("epost"));									_phone = toString(query("phone"));									_mobile = toString(query("mobilnr"));								}								%>								<option value="<%=query("medlemsnummer")%>"<%=(medlemsnr == query("medlemsnummer")) ? "selected" : ""%>><%=query("förnamn")%>&nbsp;<%=query("efternamn")%></option>								<%								query.MoveNext();							}							%>							</select><br/>						<% } %>						<b>Namn</b><br/>						<input name="name" value="<%=_name%>"/><br/>						<b>Epost</b><br/>						<input name="email" value="<%=_email%>"/><br/>						<b>Telefon</b><br/>						<input name="phone" value="<%=_phone%>"/><br/>						<b>Mobil</b><br/>						<input name="mobile" value="<%=_mobile%>"/><br/>						<b>Bonus 2009-12-31</b><br/>						<input name="bonus_2007" value="<%=_bonus_2007%>" size="5"/>kr<br/>						<b>Bonussaldo</b><br/>						<%=_bonus%> kr<br/>						<b>Användarnamn</b><br/>						<input name="username" value="<%=_username%>"/><br/>						<b>Lösenord</b><br/>						<input name="password" value="<%=_password%>"/><br/>						<b>Roller</b><br>						<%						for (var i = 0; i < roleArr.length; i++) {							var checked = _roles.indexOf(roleArr[i]) > -1;							%>							<%=roleArr[i]%><input type="checkbox" name="roles" value="<%=roleArr[i]%>" <%=checked ? "CHECKED" : ""%>>&nbsp;&nbsp;						<% } %>						<br>						<input name="save" type="submit" value="Spara"/>					</form>					</div>				</div>			</div>			<div id="rightColumn">				<div class="box">					<div class="header">.: Användare :.</div>					<div class="content">						<a href="?action=new">Skapa ny användare</a><br/><br/>						<%						var users = Server.CreateObject("adodb.recordset");						var sql = "SELECT * FROM user ORDER BY Name";						users.open(sql,connect,1,1);						while(!users.EOF) {							%>							<a href="?id=<%=users("id")%>"><%=users("name")%></a><br/>							<%							users.MoveNext();						}						users.close();						%>					</div>				</div>				<span class="divider">&nbsp;</span>			</div>			<div id="footer">&nbsp;</div>		</div>	</div>	</body></html><% } %>